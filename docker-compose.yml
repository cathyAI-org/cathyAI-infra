services:
  ollama-api:
    build: ./ollama-api
    container_name: cathyai-api
    env_file:
      - ./ollama-api/.env
    ports:
      - "8100:8100"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

  prompt-composer:
    build: ./prompt-composer
    container_name: cathyai-prompt-composer
    env_file:
      - ./prompt-composer/.env
    ports:
      - "8110:8110"
    restart: unless-stopped

  ai-orchestrator:
    build: ./ai-orchestrator
    container_name: cathyai-ai-orchestrator
    env_file:
      - ./ai-orchestrator/.env
    depends_on:
      - prompt-composer
      - ollama-api
    ports:
      - "8120:8120"
    volumes:
      - ./state/orchestrator:/state
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
